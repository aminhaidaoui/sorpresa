<script>

let current=1;

function next(){
  document.getElementById("page"+current).classList.remove("active");
  current++;

  document.getElementById("page"+current).classList.add("active");

  /* üî• avvia macchina da scrivere SOLO quando arrivi alla lettera */
  if(current === 3){
    startTyping();
  }
}

/* ---------- COUNTDOWN ---------- */
let c=3;
const count=document.getElementById("count");

setInterval(()=>{
  c--;
  count.innerHTML=c;
  if(c===0) next();
},1000);

/* ---------- MUSICA AUTOPLAY + iPhone fallback ---------- */
const music=document.getElementById("music");
music.play().catch(()=>{});

document.body.addEventListener("click",()=>{
  music.play();
},{once:true});

/* ---------- TYPEWRITER FIX (NESSUN GLITCH) ---------- */

const text=`Cara Cami,

sono stato colpito da te, dal tuo carattere e dalla tua bellezza.
Mi stai facendo credere di nuovo nell‚Äôamore.

Mi piace tutto di te, ogni sguardo, ogni sorriso.
Non abbiamo iniziato nel migliore dei modi,
ma finiremo nel migliore.

Il tuo Amin ‚ù§Ô∏è`;

let i=0;
const target=document.getElementById("typed");

function startTyping(){
  i=0;
  target.innerHTML="";   // reset

  const typing=setInterval(()=>{
    target.innerHTML += text.charAt(i);
    i++;

    if(i>=text.length){
      clearInterval(typing);
    }
  },25);
}

/* ---------- NO CHE SCAPPA ---------- */
const noBtn=document.getElementById("noBtn");
noBtn.onmouseover=()=>{
  noBtn.style.left=Math.random()*80+"%";
  noBtn.style.top=Math.random()*80+"%";
}

/* ---------- FINALE CON ORARIO ---------- */

function yes(){

  const now=new Date();
  const ora = now.getHours().toString().padStart(2,'0') + ":" +
              now.getMinutes().toString().padStart(2,'0');

  document.body.innerHTML=
  `
  <div class="final">
    <h1>‚ù§Ô∏è Sono felicissimo ‚ù§Ô∏è</h1>
    <img src="foto6.jpg.jpeg">
    <h2 style="margin-top:20px">Siamo ufficialmente fidanzati üíï</h2>
    <p style="margin-top:8px">Alle ore ${ora}</p>
  </div>
  `;
}

/* ---------- CUORI ---------- */
setInterval(()=>{
  const h=document.createElement("div");
  h.className="heart";
  h.innerHTML="‚ù§Ô∏è";
  h.style.left=Math.random()*100+"vw";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),5000);
},300);

</script>
